-- 1 INNER JOIN: transactions with valid customers and products
SELECT
  o.order_id,
  c.full_name,
  r.region_name,
  p.product_name,
  oi.quantity,
  (oi.quantity * oi.unit_price) AS line_total
FROM orders o
JOIN customers c   ON c.customer_id = o.customer_id
JOIN regions r     ON r.region_id = c.region_id
JOIN order_items oi ON oi.order_id = o.order_id
JOIN products p    ON p.product_id = oi.product_id
ORDER BY o.order_id;

This query returns only valid sales transactions where the order, customer, and product all match correctly. It is used for accurate revenue reporting because every row represents a real confirmed purchase line.
--------------------------------------------------------------------
-- 2 LEFT JOIN: customers with no orders
SELECT
  c.customer_id,
  c.full_name,
  r.region_name,
  o.order_id
FROM customers c
JOIN regions r ON r.region_id = c.region_id
LEFT JOIN orders o ON o.customer_id = c.customer_id
WHERE o.order_id IS NULL
ORDER BY c.customer_id;

This query lists customers who exist in the system but have never placed an order. It helps the business identify inactive customers for follow-up marketing or to verify if customer records are incomplete.
-------------------------------------------------------------------
-- 3 RIGHT JOIN: products with no order_items (no sales)
SELECT
  p.product_id,
  p.product_name,
  p.category,
  p.unit_price,
  oi.order_item_id
FROM order_items oi
RIGHT JOIN products p ON p.product_id = oi.product_id
WHERE oi.order_item_id IS NULL
ORDER BY p.product_id;

This query shows products that are in the inventory table but have no matching sales records in order_items. It helps detect slow-moving or unsold products so the company can discount them, bundle them, or stop stocking them.
--------------------------------------------------------------------
-- FULL OUTER JOIN: customers and products by region, including unmatched regions
SELECT
  COALESCE(c.region_id, p.region_id) AS region_id,
  r.region_name,
  c.customer_id,
  c.full_name,
  p.product_id,
  p.product_name
FROM customers c
FULL OUTER JOIN products p
  ON c.region_id = p.region_id
LEFT JOIN regions r
  ON r.region_id = COALESCE(c.region_id, p.region_id)
ORDER BY region_id, c.customer_id, p.product_id;

This query combines customers and products by region and still includes regions where one side is missing. It highlights stockâ€“demand mismatches, such as regions with customers but few products (stock shortage risk) or products but low customer activity (low demand risk).
--------------------------------------------------------------------
-- SELF JOIN: customers in same region (pairs)
SELECT
  a.region_id,
  r.region_name,
  a.customer_id AS customer_a_id,
  a.full_name   AS customer_a_name,
  b.customer_id AS customer_b_id,
  b.full_name   AS customer_b_name
FROM customers a
JOIN customers b
  ON a.region_id = b.region_id
 AND a.customer_id < b.customer_id
JOIN regions r ON r.region_id = a.region_id
ORDER BY a.region_id, a.customer_id, b.customer_id;

This query pairs customers who belong to the same region to compare them within a shared market area. It can support regional targeting, referral programs, or checking for potential duplicate customer entries.
